---
title: "Billboard Hot 100 Analysis (2000-2018)"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
runtime: shiny
---

```{r}
#importing the required libraries
library(flexdashboard)
library(DT)
library(lubridate) #to format dates, which are not in an ideal format
library(shiny)

```


```{r}
#data preprocessing and reactivity

#importing the dataset
billboard_data <- read.csv("C:/Users/prakh/Desktop/Semester III/R Shiny/Homework 2/billboard.csv")

#extracting the year from the date
a=mdy(billboard_data$date)
billboard_data$year<-(year(a))

#dropping unnecessary "date" column
billboard_data = subset(billboard_data, select = -c(date) )

# Subsetting data for filtering based on selection of year of release
billboard_subset <- reactive({
req(input$selected_type) # ensure availablity of value before proceeding
filter(billboard_data, year %in% input$selected_type)
})

# Updating the size of the sample subset
observe({
  updateNumericInput(session, 
                     inputId = "n_samp",
                     value = min(1000, nrow(billboard_subset())),
                     max = nrow(billboard_subset())
  )
})

# A new dataframe that subsets the sample based on the size requested
billboard_sample <- reactive({ 
  req(input$n_samp) 
  sample_n(billboard_subset(), input$n_samp)
  })

```


Sidebar {.sidebar}
-----------------------------------------------------------------------

```{r}
selectInput("song_year", label = "Select the year of release for the song:",
            choices = c(2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,
                        2011,2012,2013,2014,2015,2016,2017,2018), selected = 2015)

```

Column
-----------------------------------------------------------------------

```{r}
#rendering the data table
DT::renderDataTable(
  DT::datatable(data = billboard_data, 
                  options = list(pageLength = 10), 
                  rownames = FALSE)
)

```
